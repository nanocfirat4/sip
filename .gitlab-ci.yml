stages:
  - build
  - test

buildAll:
  stage: build
  script:
        - mvn --batch-mode package
  artifacts:
     paths:
        - ./sip-api/target/*.jar
        - ./sip-react/target/*.jar
        - ./sip-databaseloader/target/*.jar

buildMASTER:
  stage: build
  script:
      - docker login -u sipGroup1 -p _y-_NspLTc9y6WNjNm9k cr.gitlab.fhnw.ch/b-ls-mi-sip/projects-2021/sip2021-01-sth
      - cd sip-databaseloader
      - mvn clean compile jib:build -Dimage=cr.gitlab.fhnw.ch/b-ls-mi-sip/projects-2021/sip2021-01-sth/sipdataloader
      - cd ..
      - cd sip-api
      - mvn clean compile jib:build -Dimage=cr.gitlab.fhnw.ch/b-ls-mi-sip/projects-2021/sip2021-01-sth/sipapi
  only:
      - master

test:
  stage: test
  script:
    - mvn surefire-report:report
  artifacts:
    paths:
      - ./sip-react/target/site/*
      - ./sip-api/target/site/*
      - ./sip-databaseloader/target/site/*
